<html dir="rtl">
<head>
<title>

لعبة </title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<script src="animation.js" ></script>
<script src="player.js" ></script>
<script src="food.js"></script>
<script src="enmy.js"></script>
<canvas id="ctx" width="500" height="500" style="border:1px solid #000000;width:100%;"></canvas>
<script>
var edx=document.getElementById("ctx").getContext("2d")
var cn=document.getElementById("ctx")
var stor
var p=new player();
var food=new food();

var tiled_w=15;
var tiled_h=15;
var tilshet=new Image()


tilshet.src="tile-scroll.png"
var e=new enmy()
var e2=new enmy()
e2.z=900
var e3=new enmy()
e3.cha(835,340)

var e4=new enmy()
e4.cha(775,830)

var tile=[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
          3,1,3,0,0,3,0,0,0,0,0,0,0,0,3,
		  3,0,0,3,0,3,0,1,0,0,0,0,0,0,3,
		  3,0,0,0,1,3,0,1,0,0,0,0,0,0,3,
		  3,0,3,3,3,3,1,0,3,0,0,0,0,0,3,
		  3,0,0,1,1,3,0,0,3,3,3,3,3,0,3,
		  3,0,0,0,1,3,0,0,0,0,0,0,3,0,3,
		  3,0,3,3,3,3,3,3,3,3,3,0,3,0,3,
		  3,0,0,0,0,3,0,1,0,0,0,0,3,0,3,
		  3,0,0,0,0,3,0,1,3,3,3,3,3,0,3,
		  3,0,3,3,3,3,0,1,0,3,0,0,0,0,3,
		  3,0,0,0,0,3,3,3,0,3,0,0,0,0,3,
		  3,0,0,0,0,3,0,1,0,3,0,0,0,0,3,
		  3,0,0,0,0,1,0,1,0,3,0,0,0,0,3,
			  
		  3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]

function repeatOften() {
  // Do whatever
  edx.clearRect(p.x-250,p.z-250,500,500);
 for(let i=0;i<tiled_w;i++)
{
for(let w=0;w<tiled_h;w++)
{
edx.drawImage(tilshet,tile[(i*tiled_w)+w]*16,0,16,16,100*w,100*i,100,100)
}
}
food.drow(edx);

p.drow(edx);
e.drow(edx);
e2.drow(edx)
e3.drow(edx)
e4.drow(edx)

e4.checo(p)
e.checo(p)
e2.checo(p)
e3.checo(p)
food.chekco(p)
this.edx.font = "20px Arial";
this.edx.fillText(" لديك  "+p.fo +" من 4 اكل", p.x+150, p.z-180);
if(!p.isdie)
  requestAnimationFrame(repeatOften);
}
requestAnimationFrame(repeatOften);
function hunkey(event )
{
p.curent(tile);
p.handkey(event);
}
document.onkeydown=hunkey;
 document.onkeyup = myKeyUpHandler;
  document.onmousemove= function()
  {

  }
    function myKeyUpHandler() {
      p.an.curentanim=0
	  p.an.curentfrm=0;
    }
	function on_canvas_click(ev)
	{
	 var r = this.getBoundingClientRect();
 var pos = {
       x : ev.pageX-r.left,
       y : ev.pageY-r.top 
   };
   console.log((pos.x+200)+" px"+p.x)
	if(pos.x<100)
	{
	var e={key:"ArrowLeft"}
	p.handkey(e);
	}
	if(pos.y<100)
	{
	var e={key:"ArrowUp"}
	p.handkey(e);
	}
	if(pos.y>400)
	{
	var e={key:"ArrowDown"}
	p.handkey(e);
	}
	if(pos.x>400 && pos.y>50)
	{
	var e={key:"ArrowRight"}
	p.handkey(e);
	}
	}
cn.addEventListener('click', on_canvas_click, false);
</script>

</body>
</html>
